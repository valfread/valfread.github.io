{{ define "main" }}
<div class="links-container">

  <div class="links-intro">
    {{ .Content }}
  </div>

  {{/* 1. 直接读取数据 */}}
  {{ $linksData := .Site.Data.links }}

  <div class="links-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 2.5rem; margin-top: 3rem;">
    {{ range $linksData }}
      {{/* 只要没有被标记为 lost，就显示在上方 */}}
      {{ if not .lost }}
      <div class="friend-card" style="border-left: 3px solid #eee; padding-left: 1.2rem; display: flex; align-items: center; margin-bottom: 1rem;">
        <div class="friend-avatar" style="width: 55px; height: 55px; flex-shrink: 0; margin-right: 1.2rem;">
          {{ if .avatar }}
            <img src="{{ .avatar | relURL }}" alt="{{ .name }}" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 1px solid #f0f0f0;">
          {{ else }}
            <div style="width: 100%; height: 100%; border-radius: 50%; background-color: #f0f4f8; display: flex; align-items: center; justify-content: center; font-weight: 700; color: #57606a;">
              {{ substr .name 0 1 }}
            </div>
          {{ end }}
        </div>
        <div class="friend-info">
          <div class="friend-name" style="font-weight: 700;">
            <a href="{{ .url }}" target="_blank" style="color: var(--color-deep-blue) !important; text-decoration: none;">{{ .name }}</a>
          </div>
          <div class="friend-bio" style="font-size: 0.9rem; color: #888; margin-top: 0.3rem;">
            {{ .bio }}
          </div>
        </div>
      </div>
      {{ end }}
    {{ end }}
  </div>

  {{/* 2. 处理失效链接：移除灰色滤镜和透明度，保持视觉一致 */}}
  <div class="lost-friends-section" style="margin-top: 5rem;">
    <details style="cursor: pointer; border-top: 1px solid #eee; padding-top: 2rem;">
      <summary style="font-size: 1 rem; outline: none; margin-bottom: 2rem;">
        失效或断更的友链
      </summary>
      <div class="links-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 2.5rem;">
        {{ range $linksData }}
          {{ if .lost }}
          <div class="friend-card" style="border-left: 3px solid #eee; padding-left: 1.2rem; display: flex; align-items: center; margin-bottom: 1rem;">
            <div class="friend-avatar" style="width: 55px; height: 55px; flex-shrink: 0; margin-right: 1.2rem;">
              {{ if .avatar }}
                <img src="{{ .avatar | relURL }}" alt="{{ .name }}" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 1px solid #f0f0f0;">
              {{ else }}
                <div style="width: 100%; height: 100%; border-radius: 50%; background-color: #f0f4f8; display: flex; align-items: center; justify-content: center; font-weight: 700; color: #57606a;">
                  {{ substr .name 0 1 }}
                </div>
              {{ end }}
            </div>
            <div class="friend-info">
              {{/* 失效链接也恢复为深蓝色名字 */}}
              <div style="font-weight: 700; color: var(--color-deep-blue) !important;">{{ .name }}</div>
              <div style="font-size: 0.9rem; color: #888; margin-top: 0.3rem;">{{ .bio }}</div>
            </div>
          </div>
          {{ end }}
        {{ end }}
      </div>
    </details>
  </div>

  <div style="margin-top: 4rem;">
    {{ partial "comments.html" . }}
  </div>
</div>
{{ end }}